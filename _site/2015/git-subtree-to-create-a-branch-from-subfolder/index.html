<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Maybe a -> Blog - Git Subtree to create branches from subfolder</title>
  <link rel="shortcut icon" href="/assets/images/favicon.ico">
  <link rel="stylesheet" href="/assets/css/style.css">
  <link rel="alternate" type="application/rss+xml" title="My Blog" href="/rss.xml">
  <link rel="stylesheet" href="/assets/css/highlight.css">
</head>
<body>

  <nav class="main-nav">
    
        <a href='/'> <span class="arrow">‚Üê</span> Home </a>
    

    
</nav>


  

  <section id="wrapper" class="">
    <article class="post">
    <header>
        <h1>Git Subtree to create branches from subfolder</h1>
        <h2 class="headline">July 11, 2015</h2>
    </header>
    <section id="post-body">
        <p>This post is about using <code>git subtree merge</code> to have a branch that is a subset of another branch. 
Github will be a use case and act as a way to illustrate this feature, there are probably other
ways to accomplish the same result.</p>

<p>Github has a way for users to host and serve static web pages
which is very pratical if you need to create a page for your open source project
or create a blog like the one that you are reading now!</p>

<p>If you have never heard about Github Pages then the first place to start is, of course,
the official docs: <code>Github Pages &lt;http://pages.github.com/&gt;</code><em>.
But if you are interested in building a custom page, I found most of my answers
on their <code>help page &lt;https://help.github.com/categories/20/articles&gt;</code></em>.</p>

<p>A quick summary ...</p>

<p>There is 3 types of Github page: <em>User</em> page, <em>Organisation</em> page and <em>Project</em> page</p>

<ul>
<li><p>The User and Organisation page share the same behavior :</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">The static page is read from the ``master`` branch in the repo called ``username.github.com`` 
and for organisation ``organisation.github.com``.

Which means you should have some something like this for the repo url for a User Page:

::

        [SSH]     git@github.com:username/username.github.com.git 
        [HTTPS]   https://github.com/username/username.github.com.git

For organisation:

::

        [SSH]     git@github.com:organisation/organisation.github.com.git 
        [HTTPS]   https://github.com/organisation/organisation.github.com.git

The website will be accesible via ``username.github.com`` or ``organisation.github.com`` and
it will read the index.html inside the root folder.

eg: You can find the repo for this blog on https://github.com/rach/rach.github.com and view it as web page via http://rach.github.com/
</code></pre></div></li>
<li><p>The Project Page is slightly different :</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">Static pages are read from the ``gh-pages`` branch in your ``projectname`` repo and access to the website is via ``username.github.com/projectname``.
</code></pre></div></li>
</ul>

<p>Now we have established the problem, maybe for some reason you don&#39;t want to have
your static website in the root folder. In my case, I&#39;m using <code>Pelican &lt;http://pelican.notmyidea.org/&gt;</code>_ to build this blog 
and I want to have the static website in a directory that I specify.
I won&#39;t be specific to <code>Pelican &lt;http://pelican.notmyidea.org/&gt;</code>_ so if you are using anything to generate your pages and you don&#39;t want to expose it directly (Markdown, Less, Rst, Template), this should remain informative.</p>

<p>Let&#39;s assume for the following that we are building a User Github Page and
you have a source and output folder as below:</p>

<p>::</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">    (root)
       |-&gt; output
       |-&gt; source
</code></pre></div>
<p>Here, we would like to have the master branch focused on the output folder so it will be served by Github Pages. A perfect use case for subtree merge. 
The doc on git subtree merge say:</p>

<p>| <em>&quot;There are situations where you want to include contents in your project
  from an independently developed project. 
 You can just pull from the other project as long as there are no conflicting paths.</em>
| ...
| <em>What you want is the subtree merge strategy, which helps you in such a situation.&quot;</em>
  <code>ref &lt;http://www.kernel.org/pub/software/scm/git/docs/howto/using-merge-subtree.html&gt;</code>_</p>

<p>In our case we are not going to pull from another project, but the idea is the same. 
Or in other words, we want to have the root of <code>master</code> branch pointing the <code>output</code> 
of the <code>source</code> branch and for it to be easy to update.
Hence, we are going to merge the <code>output</code> folder of the <code>source</code> branch of same repository into the <code>master</code>.</p>

<p>Here is the command sequence I used: </p>

<p>.. code-block:: none</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">    (source)$ git checkout --orphan master
    (master)$ git rm -rf .
    (master)$ git merge -s ours --no-commit origin/source
    (master)$ git read-tree -m -u source:output
    (master)$ git commit -m &quot;Merge folder output of branch source&quot;
</code></pre></div>
<ol>
<li>Create an orphan branch, which is a branch without a parent.</li>
<li>Remove any previously tracked element.</li>
<li>Prepare for the later step which will record the result as a merge.</li>
<li>Read folder <code>output</code> of branch <code>source</code> into the current directory.</li>
<li>Commit the merge.</li>
</ol>

<p>Enjoy your website on <code>http://username.github.com</code></p>

<p>.. note:: For maintaining the result,  merges using &quot;subtree&quot; </p>
<div class="highlight"><pre><code class="language-text" data-lang="text">    ::

             git pull -s subtree origin source
</code></pre></div>
<p>.. note::  Alternative to create an empty branch</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">    ::

            true | git mktree | xargs git commit-tree | xargs git branch master
</code></pre></div>
    </section>
</article>
<footer id="post-meta" class="clearfix">
    <a href="http://twitter.com/rachbelaid">
        <img class="avatar" src="/assets/images/avatar.png">
        <div>
            <span class="dark">Rachid Belaid</span>
            <span>Blogging about programming,<br/> computer sciences, databases and others stuffs</span>
        </div>
    </a>

    <section id="sharing">
        
  
  <a class="twitter" href="https://twitter.com/intent/tweet?text=http://bit.ly/1HXPPVz - Git Subtree to create branches from subfolder by @rachbelaid"><span class="icon-twitter"></span></a>
  <a class="facebook" href="#" onclick="
      window.open(
        'https://www.facebook.com/sharer/sharer.php?u='+encodeURIComponent(location.href),
        'facebook-share-dialog',
        'width=626,height=436');
      return false;"><span class="icon-facebook"></span>
  </a>


    </section>
</footer>

<!-- Archive post list -->

    <ul id="post-list" class="archive readmore">
        <h3>Read more</h3>
        
            <li>
                <a href="/2015/postgres-full-text-search-is-good-enough/">Postgres full-text search is Good Enough!<aside class="dates">Jul 13</aside></a>
            </li>
        
            <li>
                <a href="/2015/git-subtree-to-create-a-branch-from-subfolder/">Git Subtree to create branches from subfolder<aside class="dates">Jul 11</aside></a>
            </li>
        
            <li>
                <a href="/2015/virtualenvwrapper-plugins-for-gems-and-npms/">Virtualenvwrapper plugins for gems and npms<aside class="dates">Jul 10</aside></a>
            </li>
        
            <li>
                <a href="/2015/keep-your-gems-and-npms-inside-your-virtualenv/">Keep your gems and npms inside your virtualenv<aside class="dates">Jul 09</aside></a>
            </li>
        
            <li>
                <a href="/2015/handling-go-workspace-with-direnv/">Handling Go workspace with direnv<aside class="dates">Jun 28</aside></a>
            </li>
        
    </ul>





  </section>

  <script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
  <script src="/assets/js/main.js"></script>
  <script src="/assets/js/highlight.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>

  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-XXXXXXXX-X', 'auto');
    ga('send', 'pageview');
  </script>
</body>
</html>



